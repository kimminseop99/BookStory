<html layout:decorate="~{layout/layout}">
<div layout:fragment="content">
    <div class="max-w-7xl mx-auto p-6">
        <!-- 상단 헤더 -->
        <div class="flex flex-col md:flex-row justify-between items-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800">Book Story</h1>
            <a th:href="@{/books/new}" class="mt-4 md:mt-0 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition">
                + 새 리뷰 작성
            </a>
        </div>

        <!-- 검색 창 -->
        <div class="mb-8 text-center">
            <form action="/search" method="get" onsubmit="encodeSearchQuery()">
                <input type="text" id="searchQuery" name="query" placeholder="책 검색" class="px-4 py-2 border rounded" required>
                <button type="submit" class="px-6 py-2 ml-4 bg-blue-600 text-white rounded hover:bg-blue-700 transition">
                    검색
                </button>
            </form>
        </div>

        <!-- ✅ 슬라이드 컨테이너 크기 조정 -->
        <div class="swiper-container my-6 max-w-5xl mx-auto">
            <div class="swiper-wrapper">
                <!-- ✅ 슬라이드 1개 (반복) -->
                <div th:each="book : ${bookList}" class="swiper-slide flex justify-center">
                    <div class="w-56 bg-white p-3 rounded-lg shadow-md">
                        <div class="w-full h-40 bg-gray-100 flex items-center justify-center rounded-md mb-2">
                            <img th:src="@{${book.imageUrl}}" alt="Book Cover" class="max-w-full max-h-full object-contain">
                        </div>
                        <h3 class="text-base font-semibold text-gray-800 text-center" th:text="${book.title}">책 제목</h3>
                        <p class="text-gray-600 text-sm text-center" th:text="'저자: ' + ${book.author}">저자: 홍길동</p>
                        <p class="text-gray-500 text-xs mt-1 text-center line-clamp-2" th:text="${book.content}">책 설명</p>
                        <p class="text-blue-600 text-xs text-center mt-1" th:text="'#' + ${book.hashtags}">#해시태그</p>
                    </div>
                </div>
            </div>

            <!-- ✅ 네비게이션 & 페이지네이션 -->
            <div class="swiper-pagination mt-2"></div>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
        </div>


    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
           new Swiper('.swiper-container', {
               loop: true,
               slidesPerView: 1,
               spaceBetween: 20,
               pagination: {
                   el: '.swiper-pagination',
                   clickable: true
               },
               navigation: {
                   nextEl: '.swiper-button-next',
                   prevEl: '.swiper-button-prev'
               },
               breakpoints: {
                   640: {
                       slidesPerView: 1,
                   },
                   768: {
                       slidesPerView: 2,
                   },
                   1024: {
                       slidesPerView: 3,
                   },
               }
           });
       });

       function encodeSearchQuery() {
           var queryInput = document.getElementById('searchQuery');
           queryInput.value = encodeURIComponent(queryInput.value);
       }

       window.addEventListener('pageshow', function (event) {
           if (event.persisted || window.performance && performance.navigation.type === 2) {
               document.getElementById('searchQuery').value = '';
           }
       });
    </script>
</div>
</html>